<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Reservation Control Panel Login</title>
<style>
    body {
        margin:0;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background:#1e1e26;
        display:flex;
        justify-content:center;
        align-items:center;
        height:100vh;
        color:white;
    }
    .login-box {
        background:#2a2a35;
        padding:40px;
        border-radius:15px;
        width:350px;
        text-align:center;
        box-shadow:0 8px 24px rgba(0,0,0,0.3);
    }
    .login-box h2 { margin-bottom:20px; color:#00b894; }
    .login-box p { color:#ccc; font-size:14px; margin-bottom: 20px; }
    input { 
        width:100%; 
        padding:12px; 
        margin:10px 0; 
        border-radius:8px; 
        border:1px solid #444; 
        background:#16161d; 
        color:white; 
        outline:none;
        box-sizing: border-box; 
    }
    input:focus { border-color:#00b894; }
    button { 
        width:100%; 
        padding:12px; 
        margin-top:10px; 
        border:none; 
        border-radius:8px; 
        background:#00b894; 
        color:white; 
        font-weight:bold; 
        cursor:pointer; 
        transition:0.3s; 
    }
    button:hover { background:#009475; }
    button:disabled { background:#444; cursor:not-allowed; }
    #msg { margin-top:15px; color:#ff7675; font-size:14px; min-height:20px; }
    .footer-bar {
    position: fixed;
    bottom: 0;
    left: 0;
    width: 100%;
    background: rgba(15, 15, 20, 0.9);
    backdrop-filter: blur(15px);
    -webkit-backdrop-filter: blur(15px);
    padding: 4px 0; 
    z-index: 99999;
    border-top: 1px solid rgba(0, 210, 255, 0.2);
    box-shadow: 0 -10px 30px rgba(0, 0, 0, 0.5);
    text-align: center;
    overflow: visible !important;
}


.footer-content {
    display: flex;
    flex-direction: column; 
    align-items: center;
    gap: 2px; 
}


.dev-text {
    font-size: 10px;
    color: #888;
    text-transform: uppercase;
    letter-spacing: 2px;
    line-height: 1.1;
}

.my-name {
    display: inline-block;
    background: linear-gradient(90deg, #00d2ff, #3a7bd5);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    font-weight: 800;
    margin-left: 5px;
    transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    cursor: pointer;
    filter: drop-shadow(0 0 5px rgba(0, 210, 255, 0.4));
}

.dev-text strong {
    font-weight: 800; 
}

.dev-text:hover .my-name {
    transform: scale(1.3);
    filter: drop-shadow(0 0 15px rgba(0, 210, 255, 0.9));
}


.support-text {
    font-size: 12px;
    margin: 0 0 4px 0;
    font-weight: 500;
}

.error-text {
    color: #ff4757;
    text-shadow: 0 0 8px rgba(255, 71, 87, 0.4);
}

.action-text {
    color: #25D366;
    text-shadow: 0 0 8px rgba(37, 211, 102, 0.4);
    margin-left: 5px;
}

.footer-links {
    display: flex;
    align-items: center;
    gap: 12px;
    font-size: 11px;
}

.footer-link {
    text-decoration: none;
    color: #fff;
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 8px;
    transition: 0.3s;
    opacity: 0.8;
}

.footer-link:hover {
    opacity: 1;
    transform: translateY(-2px);
}

.footer-icon {
    width: 22px;
    height: 22px;
}

.blue-phone {
    color: #00d2ff;
}

.divider {
    width: 1px;
    height: 12px;
    background: rgba(255, 255, 255, 0.15);
}


.wa-hover:hover {
    color: #25D366 !important;
    filter: drop-shadow(0 0 8px #25D366) drop-shadow(0 0 18px #25D366);
}

.call-hover:hover {
    color: #00d2ff !important;
    filter: drop-shadow(0 0 8px #00d2ff) drop-shadow(0 0 18px #00d2ff);
}

.wa-hover:active {
    transform: scale(0.9);
    color: #25D366 !important;
    filter: drop-shadow(0 0 10px #25D366) drop-shadow(0 0 25px #25D366) !important;
}

.call-hover:active {
    transform: scale(0.9);
    color: #00d2ff !important;
    filter: drop-shadow(0 0 10px #00d2ff) drop-shadow(0 0 25px #00d2ff) !important;
}


</style>
</head>
<body>

<div class="login-box">
    <h2>Reservation Control Panel Login</h2>
    <p>Sign in to manage your system</p>
    <input type="email" id="email" placeholder="Email Address">
    <input type="password" id="password" placeholder="Password">
    <button id="loginBtn" onclick="login()">Login</button>
    <p id="msg"></p>
</div>
<div class="footer-bar">
  <div class="footer-content">
    

    <span class="dev-text">
      <strong>
        Developed by <span class="my-name">Mahmoud El-Hawary</span> — 
        <span class="error-text">Can’t log in?</span>
        <span class="action-text">Contact support</span>
      </strong>
    </span>
    <div class="footer-links">
      <a href="https://wa.me/201284371004" target="_blank" class="footer-link wa-hover">
        <img src="https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg" class="footer-icon" alt="WhatsApp">
        WhatsApp
      </a>

      <div class="divider"></div>

      <a href="tel:+201284371004" class="footer-link call-hover">
        <svg class="footer-icon" viewBox="0 0 24 24" fill="#00d2ff">
          <path d="M6.62 10.79a15.053 15.053 0 006.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"/>
        </svg>
        Call
      </a>

    </div>

  </div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
import { initializeAppCheck, ReCaptchaV3Provider } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app-check.js";
import { getAuth, signInWithEmailAndPassword, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-auth.js";


const firebaseConfig = {
    apiKey: "AIzaSyAqt4WhR-KsT5u3eQ1af0_CmKlDNC62few",
    authDomain: "kitchen-menu-28ba8.firebaseapp.com",
    projectId: "kitchen-menu-28ba8",
    storageBucket: "kitchen-menu-28ba8.appspot.com",
    messagingSenderId: "280104304769",
    appId: "1:280104304769:web:40ec1188d8a7a7234d0d80"
};

const app = initializeApp(firebaseConfig);
const appCheck = initializeAppCheck(app, {
  provider: new ReCaptchaV3Provider('6LfKZHYsAAAAACDl3MgZa-8CNmiG02xuJGNXigiV'),
  isTokenAutoRefreshEnabled: true
});
const auth = getAuth(app);


onAuthStateChanged(auth, (user) => {
    if (user) {
        const urlParams = new URLSearchParams(window.location.search);
        
        const redirectTo = urlParams.get('redirect') || 'index.html';
        window.location.href = redirectTo;
    }
});

window.login = async function() {
    const email = document.getElementById("email").value;
    const password = document.getElementById("password").value;
    const msg = document.getElementById("msg");
    const btn = document.getElementById("loginBtn");

    if(!email || !password) {
        msg.innerText = "Please enter email and password";
        return;
    }


    msg.innerText = "Authenticating...";
    msg.style.color = "#00b894";
    btn.disabled = true;

    try {
        const userCredential = await signInWithEmailAndPassword(auth, email, password);
        

        localStorage.setItem("restaurantID", userCredential.user.uid);


        const urlParams = new URLSearchParams(window.location.search);
        const redirectTo = urlParams.get('redirect') || 'index.html';
        
        window.location.href = redirectTo;

    } catch (err) {
        btn.disabled = false;
        msg.style.color = "#ff7675";
        

        if (err.code === 'auth/invalid-credential') {
            msg.innerText = "Wrong email or password!";
        } else if (err.code === 'auth/too-many-requests') {
            msg.innerText = "Too many attempts. Try again later.";
        } else {
            msg.innerText = "Error: " + err.message;
        }
        console.error(err);
    }
}

  function getKeyInfo(e){
    return {
      key: (e.key || '').toLowerCase(),
      code: (e.code || '').toLowerCase(),
      keyCode: e.keyCode || e.which || 0,
      ctrl: e.ctrlKey || false,
      shift: e.shiftKey || false,
      alt: e.altKey || false,
      meta: e.metaKey || false
    };
  }

  function handleKeydown(e){
    const k = getKeyInfo(e);

    const K = { F12: 123, U: 85, S: 83, I: 73, J: 74, C: 67, K: 75, P: 80, M: 77 };

    const isF12 = (k.keyCode === K.F12) || k.key === 'f12' || k.code === 'f12';
    const isCtrlU = (k.ctrl || k.meta) && (k.key === 'u' || k.keyCode === K.U);
    const isCtrlS = (k.ctrl || k.meta) && (k.key === 's' || k.keyCode === K.S);
    const isCtrlShiftI = (k.ctrl || k.meta) && k.shift && (k.key === 'i' || k.keyCode === K.I);
    const isCtrlShiftJ = (k.ctrl || k.meta) && k.shift && (k.key === 'j' || k.keyCode === K.J);
    const isCtrlShiftC = (k.ctrl || k.meta) && k.shift && (k.key === 'c' || k.keyCode === K.C);
    const isCtrlShiftK = (k.ctrl || k.meta) && k.shift && (k.key === 'k' || k.keyCode === K.K);
    const isCtrlShiftP = (k.ctrl || k.meta) && k.shift && (k.key === 'p' || k.keyCode === K.P);
    const isCtrlShiftM = (k.ctrl || k.meta) && k.shift && (k.key === 'm' || k.keyCode === K.M);

    if(isF12 || isCtrlU || isCtrlS || isCtrlShiftI || isCtrlShiftJ || isCtrlShiftC || isCtrlShiftK || isCtrlShiftP || isCtrlShiftM){
      e.preventDefault();
      e.stopPropagation();
      return false;
    }

    if(k.keyCode === 93 || k.key === 'contextmenu' || k.code === 'contextmenu'){
      e.preventDefault();
      e.stopPropagation();
      return false;
    }
  }

  document.addEventListener('keydown', handleKeydown, true);

  document.addEventListener('contextmenu', function(e){
    e.preventDefault();
  }, true);


  function detectByWindowSize(){
    try{
      const wDiff = Math.abs((window.outerWidth || 0) - (window.innerWidth || 0));
      const hDiff = Math.abs((window.outerHeight || 0) - (window.innerHeight || 0));
      return (wDiff > threshold) || (hDiff > threshold);
    }catch(e){
      return false;
    }
  }

  const _detector = new Image();
  Object.defineProperty(_detector, 'id', {
    get: function(){
      try{ createOverlay(); devtoolsOpen = true; }catch(e){}
      return 'detector';
    }
  });

  function checkDevTools(){
    let detected = false;
    if(detectByWindowSize()) detected = true;
    try{ console.log(_detector); }catch(e){}
    if(detected && !devtoolsOpen){
      devtoolsOpen = true;
      createOverlay();
      console.warn('DevTools detected — overlay enabled.');
    } else if(!detected && devtoolsOpen){
      devtoolsOpen = false;
      removeOverlay();
    }
  }

  const intervalId = setInterval(checkDevTools, 1000);
  window.addEventListener('resize', checkDevTools);

  document.addEventListener('keydown', function(e){
    const k = getKeyInfo(e);
    if((k.ctrl || k.meta) && k.key === 'u'){ e.preventDefault(); e.stopPropagation(); return false; }
  }, true);

  try{ console.info('Page protections (silent) enabled.'); }catch(e){}

</script>

</body>
</html>